{"version":3,"sources":["../../../../../src/dash/parser/objectiron.js"],"names":[],"mappings":"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","file":"objectiron.js","sourcesContent":["/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\nimport FactoryMaker from '../../core/FactoryMaker';\n\nfunction ObjectIron(mappers) {\n\n    function mergeValues(parentItem, childItem) {\n        for (let name in parentItem) {\n            if (!childItem.hasOwnProperty(name)) {\n                childItem[name] = parentItem[name];\n            }\n        }\n    }\n\n    function mapProperties(properties, parent, child) {\n        for (let i = 0, len = properties.length; i < len; ++i) {\n            const property = properties[i];\n\n            if (parent[property.name]) {\n                if (child[property.name]) {\n                    // check to see if we should merge\n                    if (property.merge) {\n                        const parentValue = parent[property.name];\n                        const childValue = child[property.name];\n\n                        // complex objects; merge properties\n                        if (typeof parentValue === 'object' && typeof childValue === 'object') {\n                            mergeValues(parentValue, childValue);\n                        }\n                        // simple objects; merge them together\n                        else {\n                            child[property.name] = parentValue + childValue;\n                        }\n                    }\n                } else {\n                    // just add the property\n                    child[property.name] = parent[property.name];\n                }\n            }\n        }\n    }\n\n    function mapItem(item, node) {\n        for (let i = 0, len = item.children.length; i < len; ++i) {\n            const childItem = item.children[i];\n\n            const array = node[childItem.name + '_asArray'];\n            if (array) {\n                for (let v = 0, len2 = array.length; v < len2; ++v) {\n                    const childNode = array[v];\n                    mapProperties(item.properties, node, childNode);\n                    mapItem(childItem, childNode);\n                }\n            }\n        }\n    }\n\n    function run(source) {\n\n        if (source === null || typeof source !== 'object') {\n            return source;\n        }\n\n        if ('period' in mappers) {\n            const periodMapper = mappers.period;\n            const periods = source.Period_asArray;\n            for (let i = 0, len = periods.length; i < len; ++i) {\n                const period = periods[i];\n                mapItem(periodMapper, period);\n\n                if ('adaptationset' in mappers) {\n                    const adaptationSets = period.AdaptationSet_asArray;\n                    if (adaptationSets) {\n                        const adaptationSetMapper = mappers.adaptationset;\n                        for (let i = 0, len = adaptationSets.length; i < len; ++i) {\n                            mapItem(adaptationSetMapper, adaptationSets[i]);\n                        }\n                    }\n                }\n            }\n        }\n\n        return source;\n    }\n\n    return {\n        run: run\n    };\n}\n\n\nObjectIron.__dashjs_factory_name = 'ObjectIron';\nconst factory = FactoryMaker.getClassFactory(ObjectIron);\nexport default factory;\n"]}