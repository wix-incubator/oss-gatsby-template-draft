{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 7eeb03844e12df3ca728","webpack:///./demo/main.js","webpack:///./tests/test-streams.js"],"names":["testStreams","require","defaultTestStreamUrl","url","bufferingIdx","selectedTestStream","lastSeekingIdx","lastStartPosition","lastDuration","lastAudioTrackSwitchingIdx","hls","events","stats","tracks","fmp4Data","enableStreaming","JSON","parse","getURLParam","autoRecoverError","enableWorker","levelCapping","defaultAudioCodec","undefined","widevineLicenseUrl","dumpfMP4","video","$","volume","document","ready","Object","keys","forEach","key","stream","option","Option","description","append","change","val","streamUrl","loadSelectedStream","width","hide","toggle","windowSliding","click","checked","updatePermalink","value","prop","Hls","version","html","decodeURIComponent","resetGlobals","window","t0","performance","now","load","buffer","level","bitrate","recoverDecodingErrorDate","recoverSwapAudioCodecDate","onClickBufferedRange","updateLevelInfo","createfMP4","goToMetricsPermaLink","hideCanvas","isSupported","destroy","bufferTimer","clearInterval","text","unescape","hlsConfig","debug","config","console","log","emeEnabled","loadSource","autoLevelCapping","attachMedia","on","Events","MEDIA_ATTACHED","push","time","type","MEDIA_DETACHED","FRAG_PARSING_INIT_SEGMENT","event","data","showCanvas","id","FRAG_PARSING_METADATA","LEVEL_SWITCHING","Math","round","levels","MANIFEST_PARSED","name","start","end","length","trequest","latency","tfirst","tload","duration","refreshCanvas","levelNb","levelParsed","AUDIO_TRACKS_UPDATED","audioTracks","updateAudioTrackInfo","AUDIO_TRACK_SWITCHING","AUDIO_TRACK_SWITCHED","LEVEL_LOADED","isLive","details","live","startSN","endSN","parsing","tparsed","parsingDuration","sumLevelParsingMs","levelParsingUs","AUDIO_TRACK_LOADED","FRAG_BUFFERED","frag","id2","sn","tbuffered","bw","total","size","pos","setInterval","checkBuffer","process","fragBuffered","fragMinLatency","min","fragMaxLatency","max","fragMinProcess","fragMaxProcess","fragMinKbps","fragMaxKbps","autoLevelCappingMin","autoLevelCappingMax","fragBufferedBytes","sumLatency","sumKbps","sumProcess","sumParsing","fraglastLatency","fragAvgLatency","fragLastProcess","fragAvgProcess","fragLastKbps","fragAvgKbps","fragparsingKbps","fragparsingMs","autoLevelCappingLast","LEVEL_SWITCHED","FRAG_CHANGED","tagList","autoLevel","levelStart","fragChangedAuto","autoLevelMin","autoLevelMax","levelLastAuto","autoLevelLast","autoLevelSwitch","sumAutoLevel","autoLevelAvg","fragChangedManual","manualLevelMin","manualLevelMax","manualLevelLast","manualLevelSwitch","FRAG_LOAD_EMERGENCY_ABORTED","fragLoadEmergencyAborted","FRAG_DECRYPTED","fragDecrypted","totalDecryptTime","fragAvgDecryptTime","tdecrypt","tstart","ERROR","warn","ErrorDetails","MANIFEST_LOAD_ERROR","context","response","code","err","MANIFEST_LOAD_TIMEOUT","MANIFEST_PARSING_ERROR","reason","LEVEL_LOAD_ERROR","LEVEL_LOAD_TIMEOUT","LEVEL_SWITCH_ERROR","FRAG_LOAD_ERROR","FRAG_LOAD_TIMEOUT","FRAG_LOOP_LOADING_ERROR","FRAG_DECRYPT_ERROR","FRAG_PARSING_ERROR","KEY_LOAD_ERROR","decryptdata","uri","KEY_LOAD_TIMEOUT","BUFFER_APPEND_ERROR","BUFFER_ADD_CODEC_ERROR","mimeType","message","BUFFER_APPENDING_ERROR","fatal","ErrorTypes","MEDIA_ERROR","handleMediaError","NETWORK_ERROR","fatalError","stringify","sortObject","BUFFER_CREATED","BUFFER_APPENDING","FPS_DROP","evt","currentDropped","currentDecoded","fpsDropEvent","fpsTotalDroppedFrames","totalDroppedFrames","addEventListener","handleVideoEvent","navigator","userAgent","toLowerCase","indexOf","target","videoWidth","videoHeight","currentTime","errorTxt","mediaError","currentTarget","error","MEDIA_ERR_ABORTED","MEDIA_ERR_DECODE","MEDIA_ERR_NETWORK","MEDIA_ERR_SRC_NOT_SUPPORTED","recoverMediaError","swapAudioCodec","timeRangesToString","r","i","v","canvas","ctx","getContext","buffered","bufferingDuration","fillStyle","fillRect","height","clientWidth","bufferLen","paused","bufEvents","bufEventLen","event0","event1","slopeBuf0","slopeBuf1","slopePos0","slopePos1","abs","pop","seekable","played","media","videoPlaybackQuality","getVideoPlaybackQuality","Function","droppedVideoFrames","corruptedVideoFrames","webkitDroppedFrameCount","x","obj","temp","sort","index","showMetrics","show","hideMetrics","getMetrics","json","jsonpacked","jsonpack","pack","btoa","copyMetricsToClipBoard","copyTextToClipboard","textArea","createElement","body","appendChild","select","successful","execCommand","msg","removeChild","goToMetrics","URL","substr","lastIndexOf","open","b64","minsecs","ts","m","floor","s","clientX","offsetLeft","button_template","button_enabled","button_disabled","html1","autoLevelEnabled","html2","html3","html4","currentLevel","levelName","label","level2label","loadLevel","nextLevel","audioTrackId","audioTrack","len","sParam","defaultValue","sPageURL","location","search","substring","sURLVariables","split","sParameterName","hlsLink","encodeURIComponent","escape","blob","Blob","arrayConcat","filename","Date","toISOString","saveAs","inputArray","totalLength","reduce","prev","cur","result","Uint8Array","offset","element","set","createTestStream","abr","blacklist_ua","createTestStreamWithConfig","Error","testStream","module","exports","bbb","nudgeMaxRetry","bigBuckBunny480p","arte","deltatreDAI","issue666","issue649","closedCaptions","oceansAES","bbbAES","mp3Audio","mpegAudioOnly","fmp4","fmp4Bitmovin","offset_pts","uspHLSAteam","angelOneShakaWidevine"],"mappings":"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","file":"hls-demo.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"HlsDemo\"] = factory();\n\telse\n\t\troot[\"HlsDemo\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7eeb03844e12df3ca728","const testStreams = require('../tests/test-streams');\n\nconst defaultTestStreamUrl = testStreams['bbb'].url;\n\nlet bufferingIdx = -1;\n\nlet selectedTestStream = null;\n\nlet lastSeekingIdx,\n  lastStartPosition,\n  lastDuration,\n  lastAudioTrackSwitchingIdx;\n\nlet hls,\n    url,\n    events,\n    stats,\n    tracks,\n    fmp4Data,\n    enableStreaming = JSON.parse(getURLParam('enableStreaming', true));\n    autoRecoverError = JSON.parse(getURLParam('autoRecoverError', true)),\n    enableWorker = JSON.parse(getURLParam('enableWorker', true)),\n    levelCapping = JSON.parse(getURLParam('levelCapping', -1)),\n    defaultAudioCodec = getURLParam('defaultAudioCodec', undefined),\n    widevineLicenseUrl = getURLParam('widevineLicenseURL', undefined),\n    dumpfMP4 = getURLParam('dumpfMP4', false);\n\nlet video = $('#video')[0];\n\nvideo.volume = 0.05;\n\n$(document).ready(function() {\n\n  //console.log(testStreams)\n\n  Object.keys(testStreams).forEach((key) => {\n    const stream = testStreams[key];\n    const option = new Option(stream.description, key);\n    $('#streamSelect').append(option);\n  })\n\n  $('#streamSelect').change(function() {\n    selectedTestStream = testStreams[$('#streamSelect').val()];\n    const streamUrl = selectedTestStream.url;\n    $('#streamURL').val(streamUrl);\n    loadSelectedStream();\n  });\n\n  $('#streamURL').change(function() {\n    selectedTestStream = null;\n    loadSelectedStream();\n  });\n\n  $('#videoSize').change(function() {\n    $('#video').width($('#videoSize').val());\n    $('#buffered_c').width($('#videoSize').val());\n  });\n\n  $('#PlaybackControl').hide();\n  $('#QualityLevelControl').hide();\n  $('#AudioTrackControl').hide();\n  $('#MetricsDisplay').hide();\n  $('#StatsDisplay').hide();\n  $('#metricsButtonWindow').toggle(windowSliding);\n  $('#metricsButtonFixed').toggle(!windowSliding);\n\n  $('#enableStreaming').click(function() {\n    enableStreaming = this.checked;\n    loadSelectedStream();\n  });\n\n  $('#autoRecoverError').click(function() {\n    autoRecoverError = this.checked;\n    updatePermalink();\n  });\n\n  $('#enableWorker').click(function() {\n    enableWorker = this.checked;\n    updatePermalink();\n  });\n\n  $('#dumpfMP4').click(function() {\n    dumpfMP4 = this.checked;\n    updatePermalink();\n  });\n\n  $('#levelCapping').change(function() {\n    levelCapping = this.value;\n    updatePermalink();\n  });\n\n  $('#defaultAudioCodec').change(function() {\n    defaultAudioCodec = this.value;\n    updatePermalink();\n  });\n\n  $('#enableStreaming').prop( 'checked', enableStreaming );\n  $('#autoRecoverError').prop( 'checked', autoRecoverError );\n  $('#enableWorker').prop( 'checked', enableWorker );\n  $('#dumpfMP4').prop( 'checked', dumpfMP4 );\n  $('#levelCapping').val(levelCapping);\n  $('#defaultAudioCodec').val(defaultAudioCodec || 'undefined');\n  $('h2').append(' <a target=_blank href=https://github.com/video-dev/hls.js/releases/tag/v' + Hls.version + '>v' + Hls.version + '</a>');\n\n  $('#currentVersion').html('Hls version:' + Hls.version);\n\n  $('#streamURL').val(decodeURIComponent(getURLParam('src', defaultTestStreamUrl)))\n\n  loadSelectedStream();\n\n});\n\nfunction resetGlobals() {\n  window.events = events = {\n    url    : url,\n    t0     : performance.now(),\n    load   : [],\n    buffer : [],\n    video  : [],\n    level  : [],\n    bitrate: []\n  };\n\n  // actual values, only on window\n  window.recoverDecodingErrorDate = null;\n  window.recoverSwapAudioCodecDate = null;\n\n  window.fmp4Data = fmp4Data = {\n    'audio': [],\n    'video': []\n  };\n\n  window.onClickBufferedRange = onClickBufferedRange;\n\n  window.updateLevelInfo = updateLevelInfo;\n  window.updatePermalink = updatePermalink;\n  window.createfMP4 = createfMP4;\n  window.goToMetricsPermaLink = goToMetricsPermaLink;\n}\n\nfunction loadSelectedStream() {\n\n  url = $('#streamURL').val()\n\n  hideCanvas();\n\n  if(Hls.isSupported()) {\n\n    if(hls) {\n      hls.destroy();\n      if(hls.bufferTimer) {\n        clearInterval(hls.bufferTimer);\n        hls.bufferTimer = undefined;\n      }\n      hls = null;\n    }\n\n    if(!enableStreaming) {\n      $('#HlsStatus').text('Streaming disabled');\n      return;\n    }\n\n    $('#HlsStatus').text('loading ' + url);\n\n    resetGlobals();\n\n    if (widevineLicenseUrl) {\n      widevineLicenseUrl = unescape(widevineLicenseUrl)\n    }\n\n    const hlsConfig = {\n      debug            : true,\n      enableWorker     : enableWorker,\n      defaultAudioCodec: defaultAudioCodec,\n      widevineLicenseUrl: widevineLicenseUrl\n    };\n\n    if (selectedTestStream && selectedTestStream.config) {\n      Object.assign(hlsConfig, selectedTestStream.config)\n      console.log('Using Hls.js config:', hlsConfig);\n    }\n\n    if (hlsConfig.widevineLicenseUrl) {\n      $('#widevineLicenseUrl').val(hlsConfig.widevineLicenseUrl);\n    }\n\n    widevineLicenseUrl = hlsConfig.widevineLicenseUrl = $('#widevineLicenseUrl').val();\n\n    if (hlsConfig.widevineLicenseUrl) {\n      hlsConfig.emeEnabled = true;\n    }\n\n    updatePermalink();\n\n    window.hls = hls = new Hls(hlsConfig);\n\n    $('#HlsStatus').text('loading manifest and attaching video element...');\n\n    hls.loadSource(url);\n    hls.autoLevelCapping = levelCapping;\n    hls.attachMedia(video);\n\n    hls.on(Hls.Events.MEDIA_ATTACHED, function() {\n      $('#HlsStatus').text('MediaSource attached...');\n      bufferingIdx = -1;\n      events.video.push({\n        time: performance.now() - events.t0,\n        type: 'Media attached'\n      });\n    });\n\n    hls.on(Hls.Events.MEDIA_DETACHED, function() {\n      $('#HlsStatus').text('MediaSource detached...');\n      bufferingIdx = -1;\n      tracks = [];\n      events.video.push({\n        time: performance.now() - events.t0,\n        type: 'Media detached'\n      });\n    });\n\n    hls.on(Hls.Events.FRAG_PARSING_INIT_SEGMENT, function(event, data) {\n      showCanvas();\n      var event = {\n        time: performance.now() - events.t0,\n        type: data.id + ' init segment'\n      };\n      events.video.push(event);\n    });\n\n    hls.on(Hls.Events.FRAG_PARSING_METADATA, function(event, data) {\n      //console.log(\"Id3 samples \", data.samples);\n    });\n\n    hls.on(Hls.Events.LEVEL_SWITCHING, function(event, data) {\n      events.level.push({\n        time   : performance.now() - events.t0,\n        id     : data.level,\n        bitrate: Math.round(hls.levels[data.level].bitrate/1000)\n      });\n      updateLevelInfo();\n    });\n\n    hls.on(Hls.Events.MANIFEST_PARSED, function(event, data) {\n      var event = {\n        type    : 'manifest',\n        name    : '',\n        start   : 0,\n        end     : data.levels.length,\n        time    : data.stats.trequest - events.t0,\n        latency : data.stats.tfirst - data.stats.trequest,\n        load    : data.stats.tload - data.stats.tfirst,\n        duration: data.stats.tload - data.stats.tfirst,\n      };\n      events.load.push(event);\n      refreshCanvas();\n    });\n\n    hls.on(Hls.Events.MANIFEST_PARSED, function(event, data) {\n      $('#HlsStatus').text('manifest successfully loaded,' + hls.levels.length + ' levels found');\n      stats = {\n        levelNb    : data.levels.length,\n        levelParsed: 0\n      };\n      updateLevelInfo();\n    });\n\n    hls.on(Hls.Events.AUDIO_TRACKS_UPDATED, function(event, data) {\n      $('#HlsStatus').text(data.audioTracks.length + ' audio tracks found');\n      updateAudioTrackInfo();\n    });\n\n    hls.on(Hls.Events.AUDIO_TRACK_SWITCHING, function(event, data) {\n      updateAudioTrackInfo();\n      var event = {\n        time: performance.now() - events.t0,\n        type: 'audio switching',\n        name: '@' + data.id\n      };\n      events.video.push(event);\n      lastAudioTrackSwitchingIdx = events.video.length-1;\n    });\n\n    hls.on(Hls.Events.AUDIO_TRACK_SWITCHED, function(event, data) {\n      updateAudioTrackInfo();\n      var event = {\n        time: performance.now() - events.t0,\n        type: 'audio switched',\n        name: '@' + data.id\n      };\n      if (lastAudioTrackSwitchingIdx !== undefined) {\n        events.video[lastAudioTrackSwitchingIdx].duration = event.time - events.video[lastAudioTrackSwitchingIdx].time;\n        lastAudioTrackSwitchingIdx = undefined;\n      }\n      events.video.push(event);\n    });\n\n    hls.on(Hls.Events.LEVEL_LOADED, function(event, data) {\n      events.isLive = data.details.live;\n      var event = {\n        type    : 'level',\n        id      : data.level,\n        start   : data.details.startSN,\n        end     : data.details.endSN,\n        time    : data.stats.trequest - events.t0,\n        latency : data.stats.tfirst - data.stats.trequest,\n        load    : data.stats.tload - data.stats.tfirst,\n        parsing : data.stats.tparsed - data.stats.tload,\n        duration: data.stats.tload - data.stats.tfirst\n      };\n      const parsingDuration = data.stats.tparsed - data.stats.tload;\n      if (stats.levelParsed)\n      {this.sumLevelParsingMs += parsingDuration;}\n      else\n      {this.sumLevelParsingMs = parsingDuration;}\n\n      stats.levelParsed++;\n      stats.levelParsingUs = Math.round(1000*this.sumLevelParsingMs / stats.levelParsed);\n      console.log('parsing level duration :' + stats.levelParsingUs + 'us,count:' + stats.levelParsed);\n      events.load.push(event);\n      refreshCanvas();\n    });\n\n    hls.on(Hls.Events.AUDIO_TRACK_LOADED, function(event, data) {\n      events.isLive = data.details.live;\n      var event = {\n        type    : 'audio track',\n        id      : data.id,\n        start   : data.details.startSN,\n        end     : data.details.endSN,\n        time    : data.stats.trequest - events.t0,\n        latency : data.stats.tfirst - data.stats.trequest,\n        load    : data.stats.tload - data.stats.tfirst,\n        parsing : data.stats.tparsed - data.stats.tload,\n        duration: data.stats.tload - data.stats.tfirst\n      };\n      events.load.push(event);\n      refreshCanvas();\n    });\n\n    hls.on(Hls.Events.FRAG_BUFFERED, function(event, data) {\n      var event = {\n        type    : data.frag.type + ' fragment',\n        id      : data.frag.level,\n        id2     : data.frag.sn,\n        time    : data.stats.trequest - events.t0,\n        latency : data.stats.tfirst - data.stats.trequest,\n        load    : data.stats.tload - data.stats.tfirst,\n        parsing : data.stats.tparsed - data.stats.tload,\n        buffer  : data.stats.tbuffered - data.stats.tparsed,\n        duration: data.stats.tbuffered - data.stats.tfirst,\n        bw      : Math.round(8*data.stats.total/(data.stats.tbuffered - data.stats.trequest)),\n        size    : data.stats.total\n      };\n      events.load.push(event);\n      events.bitrate.push({\n        time    : performance.now() - events.t0,\n        bitrate : event.bw,\n        duration: data.frag.duration,\n        level   : event.id\n      });\n      if(hls.bufferTimer === undefined) {\n        events.buffer.push({\n          time  : 0,\n          buffer: 0,\n          pos   : 0\n        });\n        hls.bufferTimer = window.setInterval(checkBuffer, 100);\n      }\n      refreshCanvas();\n      updateLevelInfo();\n\n      let latency = data.stats.tfirst - data.stats.trequest,\n        parsing = data.stats.tparsed - data.stats.tload,\n        process = data.stats.tbuffered - data.stats.trequest,\n        bitrate = Math.round(8 * data.stats.length / (data.stats.tbuffered - data.stats.tfirst));\n      if (stats.fragBuffered) {\n        stats.fragMinLatency = Math.min(stats.fragMinLatency, latency);\n        stats.fragMaxLatency = Math.max(stats.fragMaxLatency, latency);\n        stats.fragMinProcess = Math.min(stats.fragMinProcess, process);\n        stats.fragMaxProcess = Math.max(stats.fragMaxProcess, process);\n        stats.fragMinKbps = Math.min(stats.fragMinKbps, bitrate);\n        stats.fragMaxKbps = Math.max(stats.fragMaxKbps, bitrate);\n        stats.autoLevelCappingMin = Math.min(stats.autoLevelCappingMin, hls.autoLevelCapping);\n        stats.autoLevelCappingMax = Math.max(stats.autoLevelCappingMax, hls.autoLevelCapping);\n        stats.fragBuffered++;\n      } else {\n        stats.fragMinLatency = stats.fragMaxLatency = latency;\n        stats.fragMinProcess = stats.fragMaxProcess = process;\n        stats.fragMinKbps = stats.fragMaxKbps = bitrate;\n        stats.fragBuffered = 1;\n        stats.fragBufferedBytes = 0;\n        stats.autoLevelCappingMin = stats.autoLevelCappingMax = hls.autoLevelCapping;\n        this.sumLatency = 0;\n        this.sumKbps = 0;\n        this.sumProcess = 0;\n        this.sumParsing = 0;\n      }\n      stats.fraglastLatency = latency;\n      this.sumLatency += latency;\n      stats.fragAvgLatency = Math.round(this.sumLatency / stats.fragBuffered);\n      stats.fragLastProcess = process;\n      this.sumProcess += process;\n      this.sumParsing += parsing;\n      stats.fragAvgProcess = Math.round(this.sumProcess / stats.fragBuffered);\n      stats.fragLastKbps = bitrate;\n      this.sumKbps += bitrate;\n      stats.fragAvgKbps = Math.round(this.sumKbps / stats.fragBuffered);\n      stats.fragBufferedBytes += data.stats.total;\n      stats.fragparsingKbps = Math.round(8*stats.fragBufferedBytes / this.sumParsing);\n      stats.fragparsingMs = Math.round(this.sumParsing);\n      stats.autoLevelCappingLast = hls.autoLevelCapping;\n    });\n\n    hls.on(Hls.Events.LEVEL_SWITCHED, function(event, data) {\n      var event = {\n        time: performance.now() - events.t0,\n        type: 'level switched',\n        name: data.level\n      };\n      events.video.push(event);\n      refreshCanvas();\n      updateLevelInfo();\n    });\n\n    hls.on(Hls.Events.FRAG_CHANGED, function(event, data) {\n      var event = {\n        time: performance.now() - events.t0,\n        type: 'frag changed',\n        name: data.frag.sn + ' @ ' + data.frag.level\n      };\n      events.video.push(event);\n      refreshCanvas();\n      updateLevelInfo();\n      stats.tagList = data.frag.tagList;\n\n      let level = data.frag.level, autoLevel = data.frag.autoLevel;\n      if (stats.levelStart === undefined)\n      {stats.levelStart = level;}\n\n      if (autoLevel) {\n        if (stats.fragChangedAuto) {\n          stats.autoLevelMin = Math.min(stats.autoLevelMin, level);\n          stats.autoLevelMax = Math.max(stats.autoLevelMax, level);\n          stats.fragChangedAuto++;\n          if (this.levelLastAuto && level !== stats.autoLevelLast)\n          {stats.autoLevelSwitch++;}\n\n        } else {\n          stats.autoLevelMin = stats.autoLevelMax = level;\n          stats.autoLevelSwitch = 0;\n          stats.fragChangedAuto = 1;\n          this.sumAutoLevel = 0;\n        }\n        this.sumAutoLevel += level;\n        stats.autoLevelAvg = Math.round(1000 * this.sumAutoLevel / stats.fragChangedAuto) / 1000;\n        stats.autoLevelLast = level;\n      } else {\n        if (stats.fragChangedManual) {\n          stats.manualLevelMin = Math.min(stats.manualLevelMin, level);\n          stats.manualLevelMax = Math.max(stats.manualLevelMax, level);\n          stats.fragChangedManual++;\n          if (!this.levelLastAuto && level !== stats.manualLevelLast)\n          {stats.manualLevelSwitch++;}\n\n        } else {\n          stats.manualLevelMin = stats.manualLevelMax = level;\n          stats.manualLevelSwitch = 0;\n          stats.fragChangedManual = 1;\n        }\n        stats.manualLevelLast = level;\n      }\n      this.levelLastAuto = autoLevel;\n    });\n\n    hls.on(Hls.Events.FRAG_LOAD_EMERGENCY_ABORTED, function(event, data) {\n      if (stats) {\n        if (stats.fragLoadEmergencyAborted === undefined)\n        {stats.fragLoadEmergencyAborted = 1;}\n        else\n        {stats.fragLoadEmergencyAborted++;}\n\n      }\n    });\n\n    hls.on(Hls.Events.FRAG_DECRYPTED, function(event, data) {\n      if (!stats.fragDecrypted) {\n        stats.fragDecrypted = 0;\n        this.totalDecryptTime = 0;\n        stats.fragAvgDecryptTime = 0;\n      }\n      stats.fragDecrypted++;\n      this.totalDecryptTime += data.stats.tdecrypt - data.stats.tstart;\n      stats.fragAvgDecryptTime = this.totalDecryptTime / stats.fragDecrypted;\n    });\n\n    hls.on(Hls.Events.ERROR, function(event, data) {\n      console.warn(data);\n      switch(data.details) {\n        case Hls.ErrorDetails.MANIFEST_LOAD_ERROR:\n          try {\n            $('#HlsStatus').html('cannot Load <a href=\"' + data.context.url + '\">' + url + '</a><br>HTTP response code:' + data.response.code + ' <br>' + data.response.text);\n            if(data.response.code === 0)\n            {$('#HlsStatus').append('this might be a CORS issue, consider installing <a href=\"https://chrome.google.com/webstore/detail/allow-control-allow-origi/nlfbmbojpeacfghkpbjhddihlkkiljbi\">Allow-Control-Allow-Origin</a> Chrome Extension');}\n\n          } catch(err) {\n            $('#HlsStatus').html('cannot Load <a href=\"' + data.context.url + '\">' + url + '</a><br>Reason:Load ' + data.response.text);\n          }\n          break;\n        case Hls.ErrorDetails.MANIFEST_LOAD_TIMEOUT:\n          $('#HlsStatus').text('timeout while loading manifest');\n          break;\n        case Hls.ErrorDetails.MANIFEST_PARSING_ERROR:\n          $('#HlsStatus').text('error while parsing manifest:' + data.reason);\n          break;\n        case Hls.ErrorDetails.LEVEL_LOAD_ERROR:\n          $('#HlsStatus').text('error while loading level playlist');\n          break;\n        case Hls.ErrorDetails.LEVEL_LOAD_TIMEOUT:\n          $('#HlsStatus').text('timeout while loading level playlist');\n          break;\n        case Hls.ErrorDetails.LEVEL_SWITCH_ERROR:\n          $('#HlsStatus').text('error while trying to switch to level ' + data.level);\n          break;\n        case Hls.ErrorDetails.FRAG_LOAD_ERROR:\n          $('#HlsStatus').text('error while loading fragment ' + data.frag.url);\n          break;\n        case Hls.ErrorDetails.FRAG_LOAD_TIMEOUT:\n          $('#HlsStatus').text('timeout while loading fragment ' + data.frag.url);\n          break;\n        case Hls.ErrorDetails.FRAG_LOOP_LOADING_ERROR:\n          $('#HlsStatus').text('Frag Loop Loading Error');\n          break;\n        case Hls.ErrorDetails.FRAG_DECRYPT_ERROR:\n          $('#HlsStatus').text('Decrypting Error:' + data.reason);\n          break;\n        case Hls.ErrorDetails.FRAG_PARSING_ERROR:\n          $('#HlsStatus').text('Parsing Error:' + data.reason);\n          break;\n        case Hls.ErrorDetails.KEY_LOAD_ERROR:\n          $('#HlsStatus').text('error while loading key ' + data.frag.decryptdata.uri);\n          break;\n        case Hls.ErrorDetails.KEY_LOAD_TIMEOUT:\n          $('#HlsStatus').text('timeout while loading key ' + data.frag.decryptdata.uri);\n          break;\n        case Hls.ErrorDetails.BUFFER_APPEND_ERROR:\n          $('#HlsStatus').text('Buffer Append Error');\n          break;\n        case Hls.ErrorDetails.BUFFER_ADD_CODEC_ERROR:\n          $('#HlsStatus').text('Buffer Add Codec Error for ' + data.mimeType + ':' + data.err.message);\n          break;\n        case Hls.ErrorDetails.BUFFER_APPENDING_ERROR:\n          $('#HlsStatus').text('Buffer Appending Error');\n          break;\n        default:\n          break;\n      }\n      if(data.fatal) {\n        console.log('fatal error :' + data.details);\n        switch(data.type) {\n          case Hls.ErrorTypes.MEDIA_ERROR:\n            handleMediaError();\n            break;\n          case Hls.ErrorTypes.NETWORK_ERROR:\n            $('#HlsStatus').append(',network error ...');\n            break;\n          default:\n            $('#HlsStatus').append(', unrecoverable error');\n            hls.destroy();\n            break;\n        }\n        console.log($('#HlsStatus').text());\n      }\n      if(!stats) {\n        stats = {\n        };\n      }\n      // track all errors independently\n      if (stats[data.details] === undefined)\n      {stats[data.details] = 1;}\n      else\n      {stats[data.details] += 1;}\n\n      // track fatal error\n      if (data.fatal) {\n        if (stats.fatalError === undefined)\n        {stats.fatalError = 1;}\n        else\n        {stats.fatalError += 1;}\n\n      }\n      $('#HlsStats').text(JSON.stringify(sortObject(stats), null, '\\t'));\n    });\n\n    hls.on(Hls.Events.BUFFER_CREATED, function(event, data) {\n      tracks = data.tracks;\n    });\n\n    hls.on(Hls.Events.BUFFER_APPENDING, function(event, data) {\n      if (dumpfMP4)\n      {fmp4Data[data.type].push(data.data);}\n\n    });\n\n    hls.on(Hls.Events.FPS_DROP, function(event, data) {\n      let evt = {\n        time: performance.now() - events.t0,\n        type: 'frame drop',\n        name: data.currentDropped + '/' + data.currentDecoded\n      };\n      events.video.push(evt);\n      if (stats) {\n        if (stats.fpsDropEvent === undefined)\n        {stats.fpsDropEvent = 1;}\n        else\n        {stats.fpsDropEvent++;}\n\n        stats.fpsTotalDroppedFrames = data.totalDroppedFrames;\n      }\n    });\n    video.addEventListener('resize', handleVideoEvent);\n    video.addEventListener('seeking', handleVideoEvent);\n    video.addEventListener('seeked', handleVideoEvent);\n    video.addEventListener('pause', handleVideoEvent);\n    video.addEventListener('play', handleVideoEvent);\n    video.addEventListener('canplay', handleVideoEvent);\n    video.addEventListener('canplaythrough', handleVideoEvent);\n    video.addEventListener('ended', handleVideoEvent);\n    video.addEventListener('playing', handleVideoEvent);\n    video.addEventListener('error', handleVideoEvent);\n    video.addEventListener('loadedmetadata', handleVideoEvent);\n    video.addEventListener('loadeddata', handleVideoEvent);\n    video.addEventListener('durationchange', handleVideoEvent);\n  } else {\n    if(navigator.userAgent.toLowerCase().indexOf('firefox') !== -1)\n    {$('#HlsStatus').text('you are using Firefox, it looks like MediaSource is not enabled,<br>please ensure the following keys are set appropriately in <b>about:config</b><br>media.mediasource.enabled=true<br>media.mediasource.mp4.enabled=true<br><b>media.mediasource.whitelist=false</b>');}\n    else\n    {$('#HlsStatus').text('your Browser does not support MediaSourceExtension / MP4 mediasource');}\n\n  }\n}\n\nfunction handleVideoEvent(evt) {\n  let data = '';\n  switch(evt.type) {\n    case 'durationchange':\n      if(evt.target.duration - lastDuration <= 0.5) {\n      // some browsers reports several duration change events with almost the same value ... avoid spamming video events\n        return;\n      }\n      lastDuration = evt.target.duration;\n      data = Math.round(evt.target.duration*1000);\n      break;\n    case 'resize':\n      data = evt.target.videoWidth + '/' + evt.target.videoHeight;\n      break;\n    case 'loadedmetadata':\n    //   data = 'duration:' + evt.target.duration + '/videoWidth:' + evt.target.videoWidth + '/videoHeight:' + evt.target.videoHeight;\n    //  break;\n    case 'loadeddata':\n    case 'canplay':\n    case 'canplaythrough':\n    case 'ended':\n    case 'seeking':\n    case 'seeked':\n    case 'play':\n    case 'playing':\n      lastStartPosition = evt.target.currentTime;\n    case 'pause':\n    case 'waiting':\n    case 'stalled':\n    case 'error':\n      data = Math.round(evt.target.currentTime*1000);\n      if(evt.type === 'error') {\n        let errorTxt, mediaError=evt.currentTarget.error;\n        switch(mediaError.code) {\n          case mediaError.MEDIA_ERR_ABORTED:\n            errorTxt = 'You aborted the video playback';\n            break;\n          case mediaError.MEDIA_ERR_DECODE:\n            errorTxt = 'The video playback was aborted due to a corruption problem or because the video used features your browser did not support';\n            handleMediaError();\n            break;\n          case mediaError.MEDIA_ERR_NETWORK:\n            errorTxt = 'A network error caused the video download to fail part-way';\n            break;\n          case mediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:\n            errorTxt = 'The video could not be loaded, either because the server or network failed or because the format is not supported';\n            break;\n        }\n        if (mediaError.message)\n        {errorTxt += ' - ' + mediaError.message;}\n\n        $('#HlsStatus').text(errorTxt);\n        console.error(errorTxt);\n      }\n      break;\n    // case 'progress':\n    //   data = 'currentTime:' + evt.target.currentTime + ',bufferRange:[' + this.video.buffered.start(0) + ',' + this.video.buffered.end(0) + ']';\n    //   break;\n    default:\n      break;\n  }\n  let event = {\n    time: performance.now() - events.t0,\n    type: evt.type,\n    name: data\n  };\n  events.video.push(event);\n  if(evt.type === 'seeking')\n  {lastSeekingIdx = events.video.length-1;}\n\n  if(evt.type === 'seeked')\n  {events.video[lastSeekingIdx].duration = event.time - events.video[lastSeekingIdx].time;}\n\n}\n\nfunction handleMediaError() {\n  if(autoRecoverError) {\n    let now = performance.now();\n    if(!recoverDecodingErrorDate || (now - recoverDecodingErrorDate) > 3000) {\n      recoverDecodingErrorDate = performance.now();\n      $('#HlsStatus').append(',try to recover media Error ...');\n      hls.recoverMediaError();\n    } else {\n      if(!recoverSwapAudioCodecDate || (now - recoverSwapAudioCodecDate) > 3000) {\n        recoverSwapAudioCodecDate = performance.now();\n        $('#HlsStatus').append(',try to swap Audio Codec and recover media Error ...');\n        hls.swapAudioCodec();\n        hls.recoverMediaError();\n      } else {\n        $('#HlsStatus').append(',cannot recover, last media error recovery failed ...');\n      }\n    }\n  }\n}\n\nfunction timeRangesToString(r) {\n  let log = '';\n  for (let i=0; i<r.length; i++)\n  {log += '[' + r.start(i) + ',' + r.end(i) + ']';}\n\n  return log;\n}\n\nfunction checkBuffer() {\n  let v = $('#video')[0];\n  let canvas = $('#buffered_c')[0];\n  let ctx = canvas.getContext('2d');\n  let r = v.buffered;\n  let bufferingDuration;\n  ctx.fillStyle = 'black';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = 'gray';\n  if (r) {\n    if(!canvas.width || canvas.width !== v.clientWidth)\n    {canvas.width = v.clientWidth;}\n\n    var pos = v.currentTime, bufferLen;\n    for (var i=0, bufferLen=0; i<r.length; i++) {\n      let start = r.start(i)/v.duration * canvas.width;\n      let end = r.end(i)/v.duration * canvas.width;\n      ctx.fillRect(start, 3, Math.max(2, end-start), 10);\n      if(pos >= r.start(i) && pos < r.end(i)) {\n        // play position is inside this buffer TimeRange, retrieve end of buffer position and buffer length\n        bufferLen = r.end(i) - pos;\n      }\n    }\n    // check if we are in buffering / or playback ended state\n    if(bufferLen <= 0.1 && v.paused === false && (pos-lastStartPosition) > 0.5) {\n      // don't create buffering event if we are at the end of the playlist, don't report ended for live playlist\n      if(lastDuration -pos <= 0.5  && events.isLive === false) {\n      } else {\n        // we are not at the end of the playlist ... real buffering\n        if(bufferingIdx !== -1) {\n          bufferingDuration = performance.now() - events.t0 - events.video[bufferingIdx].time;\n          events.video[bufferingIdx].duration = bufferingDuration;\n          events.video[bufferingIdx].name = bufferingDuration;\n        } else {\n          events.video.push({\n            type: 'buffering',\n            time: performance.now() - events.t0\n          });\n          // we are in buffering state\n          bufferingIdx = events.video.length-1;\n        }\n      }\n    }\n\n    if(bufferLen > 0.1 && bufferingIdx !=-1) {\n      bufferingDuration = performance.now() - events.t0 - events.video[bufferingIdx].time;\n      events.video[bufferingIdx].duration = bufferingDuration;\n      events.video[bufferingIdx].name = bufferingDuration;\n      // we are out of buffering state\n      bufferingIdx = -1;\n    }\n\n    // update buffer/position for current Time\n    let event = {\n      time  : performance.now() - events.t0,\n      buffer: Math.round(bufferLen*1000),\n      pos   : Math.round(pos*1000)\n    };\n    let bufEvents = events.buffer, bufEventLen = bufEvents.length;\n    if(bufEventLen > 1) {\n      let event0 = bufEvents[bufEventLen-2], event1 = bufEvents[bufEventLen-1];\n      let slopeBuf0 = (event0.buffer - event1.buffer)/(event0.time-event1.time);\n      let slopeBuf1 = (event1.buffer - event.buffer)/(event1.time-event.time);\n\n      let slopePos0 = (event0.pos - event1.pos)/(event0.time-event1.time);\n      let slopePos1 = (event1.pos - event.pos)/(event1.time-event.time);\n      // compute slopes. if less than 30% difference, remove event1\n      if((slopeBuf0 === slopeBuf1 || Math.abs(slopeBuf0/slopeBuf1 -1) <= 0.3) &&\n           (slopePos0 === slopePos1 || Math.abs(slopePos0/slopePos1 -1) <= 0.3))\n      {bufEvents.pop();}\n\n    }\n    events.buffer.push(event);\n    refreshCanvas();\n\n    let log = 'Duration:'\n              + v.duration + '<br>'\n              + 'Buffered:'\n              + timeRangesToString(v.buffered) + '<br>'\n              + 'Seekable:'\n              + timeRangesToString(v.seekable) + '<br>'\n              + 'Played:'\n              + timeRangesToString(v.played) + '<br>';\n\n    if (hls.media) {\n      for(let type in tracks)\n      {log += type + ' Buffered:' + timeRangesToString(tracks[type].buffer.buffered) + '<br>';}\n\n\n      let videoPlaybackQuality = v.getVideoPlaybackQuality;\n      if(videoPlaybackQuality && typeof (videoPlaybackQuality) === typeof (Function)) {\n        log+='Dropped Frames:'+ v.getVideoPlaybackQuality().droppedVideoFrames + '<br>';\n        log+='Corrupted Frames:'+ v.getVideoPlaybackQuality().corruptedVideoFrames + '<br>';\n      } else if(v.webkitDroppedFrameCount) {\n        log+='Dropped Frames:'+ v.webkitDroppedFrameCount + '<br>';\n      }\n    }\n    $('#buffered_log').html(log);\n    $('#HlsStats').text(JSON.stringify(sortObject(stats), null, '\\t'));\n    ctx.fillStyle = 'blue';\n    let x = v.currentTime / v.duration * canvas.width;\n    ctx.fillRect(x, 0, 2, 15);\n  }\n\n}\n\nfunction sortObject(obj) {\n  if(typeof obj !== 'object')\n  {return obj;}\n  let temp = {\n  };\n  let keys = [];\n  for(let key in obj)\n  {keys.push(key);}\n  keys.sort();\n  for(let index in keys)\n  {temp[keys[index]] = sortObject(obj[keys[index]]);}\n  return temp;\n}\n\nfunction showCanvas()  {\n  showMetrics();\n  $('#buffered_log').show();\n  $('#buffered_c').show();\n}\n\nfunction hideCanvas()  {\n  hideMetrics();\n  $('#buffered_log').hide();\n  $('#buffered_c').hide();\n}\n\nfunction getMetrics() {\n  let json = JSON.stringify(events);\n  let jsonpacked = jsonpack.pack(json);\n  console.log('packing JSON from ' + json.length + ' to ' + jsonpacked.length + ' bytes');\n  return btoa(jsonpacked);\n}\n\nfunction copyMetricsToClipBoard() {\n  copyTextToClipboard(getMetrics());\n}\n\nfunction copyTextToClipboard(text) {\n  let textArea = document.createElement('textarea');\n  textArea.value = text;\n  document.body.appendChild(textArea);\n  textArea.select();\n  try {\n    let successful = document.execCommand('copy');\n    let msg = successful ? 'successful' : 'unsuccessful';\n    console.log('Copying text command was ' + msg);\n  } catch (err) {\n    console.log('Oops, unable to copy');\n  }\n  document.body.removeChild(textArea);\n}\n\nfunction goToMetrics() {\n  let url = document.URL;\n  url = url.substr(0, url.lastIndexOf('/')+1) + 'metrics.html';\n  console.log(url);\n  window.open(url, '_blank');\n}\n\nfunction goToMetricsPermaLink() {\n  let url = document.URL;\n  let b64 = getMetrics();\n  url = url.substr(0, url.lastIndexOf('/')+1) + 'metrics.html#data=' + b64;\n  console.log(url);\n  window.open(url, '_blank');\n}\n\nfunction minsecs(ts) {\n  let m = Math.floor(Math.floor(ts % 3600) / 60);\n  let s = Math.floor(ts % 60);\n  return m + ':' + (s < 10 ? '0' : '') + s;\n}\n\nfunction onClickBufferedRange(event) {\n  let canvas = $('#buffered_c')[0];\n  let v = $('#video')[0];\n  let target = (event.clientX - canvas.offsetLeft) / canvas.width * v.duration;\n  v.currentTime = target;\n}\n\nfunction updateLevelInfo() {\n\n  if (!hls.levels) {\n    return;\n  }\n\n  let button_template = '<button type=\"button\" class=\"btn btn-sm ';\n  let button_enabled  = 'btn-primary\" ';\n  let button_disabled = 'btn-success\" ';\n\n  let html1 = button_template;\n  if(hls.autoLevelEnabled) {\n    html1 += button_enabled;\n  } else {\n    html1 += button_disabled;\n  }\n\n  html1 += 'onclick=\"hls.currentLevel=-1\">auto</button>';\n\n  let html2 = button_template;\n  if(hls.autoLevelEnabled) {\n    html2 += button_enabled;\n  } else {\n    html2 += button_disabled;\n  }\n\n  html2 += 'onclick=\"hls.loadLevel=-1\">auto</button>';\n\n  let html3 = button_template;\n  if(hls.autoLevelCapping === -1) {\n    html3 += button_enabled;\n  } else {\n    html3 += button_disabled;\n  }\n\n  html3 += 'onclick=\"levelCapping=hls.autoLevelCapping=-1;updateLevelInfo();updatePermalink();\">auto</button>';\n\n  let html4 = button_template;\n  if(hls.autoLevelEnabled) {\n    html4 += button_enabled;\n  } else {\n    html4 += button_disabled;\n  }\n\n  html4 += 'onclick=\"hls.nextLevel=-1\">auto</button>';\n\n  for (let i=0; i < hls.levels.length; i++) {\n    html1 += button_template;\n    if(hls.currentLevel === i) {\n      html1 += button_enabled;\n    } else {\n      html1 += button_disabled;\n    }\n\n    let levelName = i, label = level2label(i);\n    if(label) {\n      levelName += '(' + level2label(i) + ')';\n    }\n\n    html1 += 'onclick=\"hls.currentLevel=' + i + '\">' + levelName + '</button>';\n\n    html2 += button_template;\n    if(hls.loadLevel === i) {\n      html2 += button_enabled;\n    } else {\n      html2 += button_disabled;\n    }\n\n    html2 += 'onclick=\"hls.loadLevel=' + i + '\">' + levelName + '</button>';\n\n    html3 += button_template;\n    if(hls.autoLevelCapping === i) {\n      html3 += button_enabled;\n    } else {\n      html3 += button_disabled;\n    }\n\n    html3 += 'onclick=\"levelCapping=hls.autoLevelCapping=' + i + ';updateLevelInfo();updatePermalink();\">' + levelName + '</button>';\n\n    html4 += button_template;\n    if(hls.nextLevel === i) {\n      html4 += button_enabled;\n    } else {\n      html4 += button_disabled;\n    }\n\n    html4 += 'onclick=\"hls.nextLevel=' + i + '\">' + levelName + '</button>';\n  }\n\n  let v = $('#video')[0];\n\n  if(v.videoWidth && v.videoHeight) {\n    $('#currentResolution').html(v.videoWidth + ' x ' + v.videoHeight);\n  }\n\n  if($('#currentLevelControl').html() != html1) {\n    $('#currentLevelControl').html(html1);\n  }\n\n  if($('#loadLevelControl').html() != html2) {\n    $('#loadLevelControl').html(html2);\n  }\n\n  if($('#levelCappingControl').html() != html3) {\n    $('#levelCappingControl').html(html3);\n  }\n\n  if($('#nextLevelControl').html() != html4) {\n    $('#nextLevelControl').html(html4);\n  }\n}\n\nfunction updateAudioTrackInfo() {\n  let button_template = '<button type=\"button\" class=\"btn btn-sm ';\n  let button_enabled  = 'btn-primary\" ';\n  let button_disabled = 'btn-success\" ';\n  let html1 = '';\n  let audioTrackId = hls.audioTrack, len = hls.audioTracks.length;\n\n  for (let i=0; i < len; i++) {\n    html1 += button_template;\n    if(audioTrackId === i) {\n      html1 += button_enabled;\n    } else {\n      html1 += button_disabled;\n    }\n\n    html1 += 'onclick=\"hls.audioTrack=' + i + '\">' + hls.audioTracks[i].name + '</button>';\n  }\n  $('#audioTrackControl').html(html1);\n}\n\nfunction level2label(index) {\n  if(hls && hls.levels.length-1 >= index) {\n    let level = hls.levels[index];\n    if (level.name) {\n      return level.name;\n    } else {\n      if (level.height) {\n        return(level.height + 'p / ' + Math.round(level.bitrate / 1024) + 'kb');\n      } else {\n        if(level.bitrate)\n        {return(Math.round(level.bitrate / 1024) + 'kb');}\n        else\n        {return null;}\n\n      }\n    }\n  }\n}\n\nfunction getURLParam(sParam, defaultValue) {\n  let sPageURL = window.location.search.substring(1);\n  let sURLVariables = sPageURL.split('&');\n  for (let i = 0; i < sURLVariables.length; i++) {\n    let sParameterName = sURLVariables[i].split('=');\n    if (sParameterName[0] == sParam)\n    {return 'undefined' == sParameterName[1] ? undefined : 'false' == sParameterName[1] ? false : sParameterName[1];}\n\n  }\n  return defaultValue;\n}\n\nfunction updatePermalink() {\n\n  const url = $('#streamURL').val();\n  const hlsLink = document.URL.split('?')[0] +  '?src=' + encodeURIComponent(url) +\n                    '&enableStreaming=' + enableStreaming +\n                    '&autoRecoverError=' + autoRecoverError +\n                    '&enableWorker=' + enableWorker +\n                    '&dumpfMP4=' + dumpfMP4 +\n                    '&levelCapping=' + levelCapping +\n                    '&defaultAudioCodec=' + defaultAudioCodec +\n                    '&widevineLicenseURL=' + escape(widevineLicenseUrl);\n\n  $('#StreamPermalink').html('<a href=\"' + hlsLink + '\">' + hlsLink + '</a>');\n}\n\nfunction createfMP4(type) {\n  if (fmp4Data[type].length) {\n    let blob = new Blob([arrayConcat(fmp4Data[type])], {\n      type: 'application/octet-stream'\n    });\n    let filename = type + '-' + new Date().toISOString() + '.mp4';\n    saveAs(blob, filename);\n    //$('body').append('<a download=\"hlsjs-' + filename + '\" href=\"' + window.URL.createObjectURL(blob) + '\">Download ' + filename + ' track</a><br>');\n  }\n}\n\nfunction arrayConcat(inputArray) {\n  let totalLength = inputArray.reduce( function(prev, cur) { return prev+cur.length; }, 0);\n  let result = new Uint8Array(totalLength);\n  let offset = 0;\n  inputArray.forEach(function(element) {\n    result.set(element, offset);\n    offset += element.length;\n  });\n  return result;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./demo/main.js","/**\n * Create test stream\n * @param {string} url\n * @param {string} description\n * @param {boolean} [live]\n * @param {boolean} [abr]\n * @param {string[]} [blacklist_ua]\n * @returns {{url: string, description: string, live: boolean, abr: boolean, blacklist_ua: string[]}}\n */\nfunction createTestStream (url, description, live = false, abr = true, blacklist_ua = []) {\n  return {\n    url,\n    description,\n    live,\n    abr,\n    blacklist_ua\n  };\n}\n\n/**\n * @param {Object} target\n * @param {Object} [config]\n * @returns {{url: string, description: string, live: boolean, abr: boolean, blacklist_ua: string[]}}\n */\nfunction createTestStreamWithConfig (target, config) {\n  if (typeof target !== 'object')\n    throw new Error('target should be object');\n\n  const testStream = createTestStream(target.url, target.description, target.live, target.abr, target.blacklist_ua);\n\n  testStream.config = config;\n\n  return testStream;\n}\n\nmodule.exports = {\n  bbb: createTestStreamWithConfig({\n    url: 'https://video-dev.github.io/streams/x36xhzz/x36xhzz.m3u8',\n    description: 'Big Buck Bunny - adaptive qualities'\n  },\n  {\n    // try to workaround test failing because of slow seek on Chrome/Win10\n    nudgeMaxRetry: 5\n  }\n  ),\n  bigBuckBunny480p: {\n    'url': 'https://video-dev.github.io/streams/x36xhzz/url_6/193039199_mp4_h264_aac_hq_7.m3u8',\n    'description': 'Big Buck Bunny - 480p only',\n    'live': false,\n    'abr': false,\n    'blacklist_ua': ['internet explorer']\n  },\n  arte: {\n    'url': 'https://video-dev.github.io/streams/test_001/stream.m3u8',\n    'description': 'ARTE China,ABR',\n    'live': false,\n    'abr': true\n  },\n  deltatreDAI: {\n    'url': 'https://video-dev.github.io/streams/dai-discontinuity-deltatre/manifest.m3u8',\n    'description': 'Ad-insertion in event stream',\n    'live': false,\n    'abr': false,\n    'blacklist_ua': ['internet explorer']\n  },\n  issue666: {\n    'url': 'http://www.streambox.fr/playlists/cisq0gim60007xzvi505emlxx.m3u8',\n    'description': 'hls.js/issues/666',\n    'live': false,\n    'abr': false,\n    'blacklist_ua': ['internet explorer']\n  },\n  issue649: {\n    'url': 'http://cdn3.screen9.com/media/c/W/cW87csHkxsgu5TV1qs78aA_auto_hls.m3u8?auth=qlUjeCtbVdtkDfZYrtveTIVUXX1yuSqgF8wfWabzKpX72r-d5upW88-FHuyRRdnZA_1PKRTGAtTt_6Z-aj22kw',\n    'description': 'hls.js/issues/649',\n    'live': false,\n    'abr': false\n  },\n  closedCaptions: {\n    'url': 'http://playertest.longtailvideo.com/adaptive/captions/playlist.m3u8',\n    'description': 'CNN special report, with CC',\n    'live': false,\n    'abr': false,\n    'blacklist_ua': ['safari']\n  },\n  oceansAES: {\n    'url': 'http://playertest.longtailvideo.com/adaptive/oceans_aes/oceans_aes.m3u8',\n    'description': 'AES encrypted,ABR',\n    'live': false,\n    'abr': true\n  },\n  bbbAES: {\n    'url': 'http://streambox.fr/playlists/sample_aes/index.m3u8',\n    'description': 'SAMPLE-AES encrypted',\n    'live': false,\n    'abr': false\n  },\n  mp3Audio: {\n    'url': 'https://player.webvideocore.net/CL1olYogIrDWvwqiIKK7eLBkzvO18gwo9ERMzsyXzwt_t-ya8ygf2kQBZww38JJT/8i4vvznv8408.m3u8',\n    'description': 'MP3 VOD demo',\n    'live': false,\n    'abr': false,\n    'blacklist_ua': ['safari']\n  },\n  mpegAudioOnly: {\n    'url': 'https://pl.streamingvideoprovider.com/mp3-playlist/playlist.m3u8',\n    'description': 'MPEG Audio Only demo',\n    'live': false,\n    'abr': false,\n    'blacklist_ua': ['internet explorer', 'MicrosoftEdge', 'safari', 'firefox']\n  },\n  fmp4: {\n    'url': 'https://storage.googleapis.com/shaka-demo-assets/angel-one-hls/hls.m3u8',\n    'description': 'HLS fMP4 Angel-One multiple audio-tracks',\n    'live': false,\n    'abr': false,\n    'blacklist_ua': ['safari', 'internet explorer']\n  },\n  fmp4Bitmovin: {\n    'url': 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s-fmp4/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8',\n    'description': 'HLS fMP4 by Bitmovin',\n    'live': false,\n    'abr': true,\n    'blacklist_ua': ['safari', 'internet explorer']\n  },\n  offset_pts: {\n    'url': 'https://video-dev.github.io/streams/pts_shift/master.m3u8',\n    'description': 'DK Turntable, PTS shifted by 2.3s',\n    'live': false,\n    'abr': false\n  },\n  uspHLSAteam: createTestStream(\n    'http://demo.unified-streaming.com/video/ateam/ateam.ism/ateam.m3u8?session_id=27199',\n    'A-Team movie trailer - HLS by Unified Streaming Platform'\n  ),\n  angelOneShakaWidevine: createTestStreamWithConfig({\n    url: 'https://storage.googleapis.com/shaka-demo-assets/angel-one-widevine-hls/hls.m3u8',\n    description: 'Shaka-packager Widevine DRM (EME) HLS-fMP4 - Angel One Demo',\n    blacklist_ua: ['firefox', 'safari', 'internet explorer']\n  },\n  {\n    widevineLicenseUrl: 'https://cwip-shaka-proxy.appspot.com/no_auth',\n    emeEnabled: true\n  }\n  )\n};\n\n\n\n// WEBPACK FOOTER //\n// ./tests/test-streams.js"],"sourceRoot":""}