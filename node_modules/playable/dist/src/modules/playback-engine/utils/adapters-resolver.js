"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function resolveAdapters(mediaStreams, availableAdapters) {
    var playableAdapters = [];
    var groupedStreams = groupStreamsByMediaType(mediaStreams);
    var groupedStreamKeys = Object.keys(groupedStreams);
    availableAdapters.forEach(function (adapter) {
        for (var i = 0; i < groupedStreamKeys.length; i += 1) {
            var mediaType = groupedStreamKeys[i];
            var mediaStreams_1 = groupedStreams[mediaType];
            if (adapter.canPlay(mediaType)) {
                adapter.setMediaStreams(mediaStreams_1);
                playableAdapters.push(adapter);
                break;
            }
        }
    });
    playableAdapters.sort(function (firstAdapter, secondAdapter) {
        return secondAdapter.mediaStreamDeliveryPriority -
            firstAdapter.mediaStreamDeliveryPriority;
    });
    return playableAdapters;
}
exports.resolveAdapters = resolveAdapters;
function groupStreamsByMediaType(mediaStreams) {
    var typeMap = {};
    mediaStreams.forEach(function (mediaStream) {
        if (!mediaStream.type) {
            return;
        }
        if (!Array.isArray(typeMap[mediaStream.type])) {
            typeMap[mediaStream.type] = [];
        }
        typeMap[mediaStream.type].push(mediaStream);
    });
    return typeMap;
}
//# sourceMappingURL=adapters-resolver.js.map