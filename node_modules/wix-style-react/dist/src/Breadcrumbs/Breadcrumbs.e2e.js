'use strict';

var _eyes = require('eyes.it');

var _eyes2 = _interopRequireDefault(_eyes);

var _protractor = require('../../testkit/protractor');

var _protractor2 = require('wix-ui-test-utils/protractor');

var _storybookHelpers = require('../../test/utils/storybook-helpers');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

describe('Breadcrumbs', function () {
  var storyUrl = (0, _storybookHelpers.getStoryUrl)('6. Navigation', '6.2 Breadcrumbs');

  beforeAll(function () {
    browser.get(storyUrl);
  });

  _eyes2.default.it('should display breadcrumbs', function () {
    var driverNoLinks = (0, _protractor.breadcrumbsTestkitFactory)({ dataHook: 'story-breadcrumbs-no-links' });
    var driverWithLinks = (0, _protractor.breadcrumbsTestkitFactory)({ dataHook: 'story-breadcrumbs-with-links' });

    var breadcrumbsItems = ['first item', 'second item', 'third item'];
    var breadcrumbsLinkItems = ['Wix', 'Google', 'Yahoo'];

    (0, _protractor2.waitForVisibilityOf)([driverNoLinks.element(), driverWithLinks.element()], 'Cannot find Breadcrumbs').then(function () {
      breadcrumbsItems.map(function (item, idx) {
        return expect(driverNoLinks.breadcrumbContentAt(idx)).toBe(item);
      });

      breadcrumbsLinkItems.map(function (item, idx) {
        return expect(driverWithLinks.breadcrumbContentAt(idx)).toBe(item);
      });
    });
  }, { version: '<Breadcrumbs/> - documentation fixes' });

  _eyes2.default.it('should show active item once clicked upon', function () {
    var driver = (0, _protractor.breadcrumbsTestkitFactory)({ dataHook: 'story-breadcrumbs-active' });
    var breadcrumbsItems = ['first item', 'second item', 'third item'];
    var itemToSelect = 2;

    (0, _protractor2.waitForVisibilityOf)(driver.element(), 'Cannot find Breadcrumbs').then(function () {
      breadcrumbsItems.map(function (item, idx) {
        return expect(driver.breadcrumbContentAt(idx)).toBe(item);
      });

      expect(driver.getActiveItemId()).toBe(-1);
      driver.clickBreadcrumbAt(itemToSelect);
      expect(driver.getActiveItemId()).toBe(itemToSelect);
    });
  }, { version: '<Breadcrumbs/> - documentation fixes' });

  it('should call func on item click', function () {
    var driver = (0, _protractor.breadcrumbsTestkitFactory)({ dataHook: 'story-breadcrumbs-onclick' });
    var breadcrumbsItems = ['first item', 'second item', 'third item'];
    var idxToClick = 1;

    (0, _protractor2.waitForVisibilityOf)(driver.element(), 'Cannot find Breadcrumbs').then(function () {
      breadcrumbsItems.map(function (item, idx) {
        return expect(driver.breadcrumbContentAt(idx)).toBe(item);
      });

      driver.clickBreadcrumbAt(idxToClick);
      var EC = protractor.ExpectedConditions;
      browser.wait(EC.alertIsPresent(), 10000, 'Alert is not getting present :(').then(function () {
        expect(browser.switchTo().alert().getText()).toBe('clicked element is: {"id":"' + (idxToClick + 1) + '","value":"' + breadcrumbsItems[idxToClick] + '"}');
        browser.switchTo().alert().accept();
      });
    });
  });
});